<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:fn="http://java.sun.com/jsp/jstl/functions" xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:body>

	<ui:composition template="../template/template.xhtml">
		<ui:define name="body">
			<f:view>

				<!-- Navigator -->

				<div class="container" style="margin-top: 20px;">
					<div class="row-fluid">
						<div class="span12">
							<h:form>
								<div class="navbar">
									<div class="navbar-inner">
										<h:outputLink class="brand" href="#">当前位置：</h:outputLink>
										<ul class="nav">
											<li><h:commandLink action="HOME" value="Home" actionListener="#{interestConversationManager.endTotalConversation()}" /></li>
											<li><h:commandLink action="#{interestAction.startConversation()}" value="兴趣选择"
													actionListener="#{interestConversationManager.endTotalConversation()}" /></li>
										</ul>
									</div>
								</div>
							</h:form>
						</div>
					</div>
				</div>


				<div class="container-fluid">

					<!-- Form Title -->

					<div class="row-fluid">
						<div class="span8 offset2">
							<div class="page-header text-left">
								<h2>
									兴趣选择 <small>version 1.0</small>
								</h2>
							</div>
						</div>
					</div>

					<!-- Message Region -->

					<h:panelGroup rendered="#{fn:length(facesContext.messageList) ne 0}">
						<div class="row-fluid">
							<div class="span8 offset2 text-left">
								<h:panelGroup rendered="#{fn:length(facesContext.messageList) ne 0}">
									<c:forEach items="#{facesContext.messageList}" var="msg">
										<c:if test="#{msg.severity.ordinal ne 0}">
											<div class="alert alert-error">
												<button class="close" data-dismiss="alert" type="button">×</button>
												<span class="label label-important">Error</span>&nbsp; <strong><h:outputText value="#{msg.summary}" /></strong>
											</div>
										</c:if>
										<c:if test="#{msg.severity.ordinal eq 0}">
											<div class="alert alert-success">
												<button class="close" data-dismiss="alert" type="button">×</button>
												<span class="label label-success">Success</span>&nbsp; <strong><h:outputText value="#{msg.summary}" /></strong>
											</div>
										</c:if>
									</c:forEach>
								</h:panelGroup>
							</div>
						</div>
					</h:panelGroup>

					<!-- Form -->

					<div class="row-fluid">
						<div class="span8 offset2 text-left bs-docs-example">
							<table class="table table-striped table-bordered table-hover">
								<thead>
									<tr>
										<th><p class="text-center">#</p></th>
										<th><p class="text-center">大分类</p></th>
										<th><p class="text-center">中分类</p></th>
										<th><p class="text-center">你的选择</p></th>
									</tr>
								</thead>
								<tbody>
								<c:forEach items="#{interestAction.techClassifyInfo}" var="techBean">
									<tr>
										<c:if test="#{techBean.classifyFirstRowSpan != 0}">
											<td rowspan="#{techBean.classifyFirstRowSpan}" style="vertical-align: middle;"><p class="text-center">#{techBean.classifyFirstId}</p></td>
											<td rowspan="#{techBean.classifyFirstRowSpan}" style="vertical-align: middle;"><p class="text-center">#{techBean.classifyFirstLabel}</p></td>
										</c:if>
										<td>#{techBean.classifySecondLabel}</td>
										<c:if test="#{techBean.classifyFirstRowSpan != 0}">
											<td rowspan="#{techBean.classifyFirstRowSpan}" style="vertical-align: middle;">
											<p>
												
												<h:form styleClass="form-horizontal text-center">
													<c:set var="isLiked" value="false"></c:set>
													<c:forEach items="#{interestAction.selectedTechIds}" var="techId">
														<c:if test="#{techBean.classifyFirstId == techId}">
															<h:commandButton value="取消关注" action="#{interestAction.unSelect}" styleClass="btn btn-danger">
																<f:setPropertyActionListener target="#{techSelectBean.techClassifyId}" value="#{techBean.classifyFirstId}"></f:setPropertyActionListener>
																<f:ajax render="@form"></f:ajax>
															</h:commandButton>
															<c:set var="isLiked" value="true"></c:set>
														</c:if>
													</c:forEach>
													<c:if test="#{isLiked == false}">
														<h:commandButton value="我感兴趣" action="#{interestAction.select}" styleClass="btn btn-success" >
															<f:setPropertyActionListener target="#{techSelectBean.techClassifyId}" value="#{techBean.classifyFirstId}"></f:setPropertyActionListener>
															<f:ajax render="@form"></f:ajax>
														</h:commandButton>
													</c:if>
												</h:form>
											</p>
											</td>
										</c:if>
									</tr>
								</c:forEach>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</f:view>
		</ui:define>
	</ui:composition>
</h:body>
</html>